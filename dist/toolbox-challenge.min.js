/*! toolbox-challenge 11-12-2014 */
function onReady(){createTiles(),$(".start").click(startNew),$("#winner").hide(),$("#help").popover("toggle"),$("#help").popover("hide")}function displayStats(){$("#unsuccess")[0].innerHTML="Unsuccessful Matches: "+unsuccess,$("#unsuccess").removeClass("bold"),$("#matchesMade")[0].innerHTML="Matches Made: "+matchesMade,$("#matchesMade").removeClass("bold"),$("#remaining")[0].innerHTML="Matches Remaining: "+remaining,$("#time")[0].innerHTML="Time Elapsed: "+Math.round((_.now()-time)/1e3)+" seconds"}function startNew(){$("#puzzlearea")[0].innerHTML="",createTiles(),time=_.now(),setInterval(displayStats,1e3),turn=0,started=!0,unsuccess=0,matchesMade=0,remaining=8,prevWinner&&($("header").show(),$("#winner").fadeOut(),$("#playArea").fadeIn(),prevWinner=!1)}function randomPics(){for(var a=[],b=1;32>=b;b++)a[b-1]=b;for(var c=_.shuffle(a),d=[],e=0;8>e;e++)d.push(c[e]),d.push(c[e]);return _.shuffle(d)}function createTiles(){for(var a=randomPics(),b=0;16>b;b++){var c=document.createElement("div"),d=document.createElement("img");$(d).data("to-flip","img/tile"+a[b]+".jpg"),d.className="tile clickable",$(d).click(flip),c.appendChild(d),c.style.position="relative",$("#puzzlearea").append($(c))}shuffle($("img"))}function shuffle(a){for(var b=0,c=1;4>=c;c++)for(var d=1;4>=d;d++){var e=145*(d-1),f=145*(c-1);a[b].style.left=e+"px",a[b].style.top=f+"px",a[b].src="img/tile-back.png",$(a[b]).data("flipped",!1),$(a[b]).data("matched",!1),b+=1}}function flip(){if(1==started&&2!=turn&&0==$(this).data("flipped")){var a=$("img");if(turn++,this.src=$(this).data("to-flip"),2==turn)for(var b=0;16>b;b++)$(a[b]).data("to-flip")==$(this).data("to-flip")&&1==$(a[b]).data("flipped")&&($(this).data("matched",!0),$(a[b]).data("matched",!0),$("#matchesMade").addClass("bold"),$(this).removeClass("clickable"),$(a[b]).removeClass("clickable"),matchesMade+=1,remaining-=1);$(this).data("flipped",!0),2==turn&&(setTimeout(checkTiles,1e3),turn=0)}}function winner(){$("header").hide(),$("#playArea").fadeOut(),$("#winner").fadeIn().delay(300),prevWinner=!0}function checkTiles(){for(var a=$("img"),b=0;16>b;b++)1==$(a[b]).data("flipped")&&0==$(a[b]).data("matched")&&(a[b].src="img/tile-back.png",$(a[b]).data("flipped",!1),$("#unsuccess").addClass("bold"),unsuccess+=.5,win=!1);0==remaining&&(clearInterval(displayStats),winner())}var started=!1,turn=0,unsuccess=0,matchesMade=0,remaining=8,time=_.now(),prevWinner=!1;$(onReady);